-- movie
DROP SCHEMA movie;

-- movie
CREATE SCHEMA movie;

-- address
CREATE TABLE movie.address (
	addrNo    CHAR(5)     NULL, -- �����ȣ
	sido      VARCHAR(20) NULL, -- �õ�
	sigungu   VARCHAR(20) NULL, -- �ñ���
	doro      VARCHAR(20) NULL, -- ����
	building1 INT(5)      NULL, -- �ǹ���ȣ1
	building2 INT(5)      NULL  -- �ǹ���ȣ2
);

-- board
CREATE TABLE movie.board (
	board_no      INT(11)      NOT NULL, -- �Խ��ǹ�ȣ
	user_id       VARCHAR(50)  NOT NULL, -- ȸ��id
	

_no      INT(11)      NOT NULL, -- ��ȭ_no
	board_title   VARCHAR(255) NOT NULL, -- �Խ�������
	board_content TEXT         NULL,     -- �Խ��ǳ���
	regdate       DATE         NOT NULL, -- �����
	grade         INT(11)      NULL      -- ���κ���
);

-- board
ALTER TABLE movie.board
	ADD CONSTRAINT
		PRIMARY KEY (
			board_no -- �Խ��ǹ�ȣ
		);

-- movie
CREATE TABLE movie.movie (
	movie_no      INT(11)      NOT NULL, -- ��ȭ_no
	movie_name    VARCHAR(50)  NOT NULL, -- ��ȭ�̸�
	path_poster   VARCHAR(255) NULL,     -- ������
	play_time     INT(11)      NULL,     -- �󿵽ð�
	rating        INT(11)      NULL,     -- ���
	grade         DOUBLE       NULL,     -- ������
	open_date     DATE         NULL,     -- ������
	close_date    DATE         NULL,     -- ������
	genre         VARCHAR(255) NULL,     -- �帣
	path_steelcut VARCHAR(255) NULL,     -- ��ƿ��
	path_video    VARCHAR(255) NULL,     -- ������
	synopsis      TEXT         NULL,     -- �ٰŸ�
	actor         VARCHAR(255) NULL,     -- ���
	director      VARCHAR(255) NULL      -- ����
);

-- movie
ALTER TABLE movie.movie
	ADD CONSTRAINT
		PRIMARY KEY (
			movie_no -- ��ȭ_no
		);

-- reservation
CREATE TABLE movie.reservation (
	no           INT(11)      NOT NULL, -- �����ȣ
	user_id      VARCHAR(50)  NOT NULL, -- ȸ��id
	timetable_no INT(11)      NOT NULL, -- �󿵽ð�ǥ_no
	price        INT(11)      NOT NULL, -- ����
	seat_rank    VARCHAR(255) NOT NULL  -- �¼����
);

-- reservation
ALTER TABLE movie.reservation
	ADD CONSTRAINT
		PRIMARY KEY (
			no -- �����ȣ
		);

-- theater
CREATE TABLE movie.theater (
	theater_no       INT(11)      NOT NULL, -- theater_no
	theather_name    VARCHAR(255) NOT NULL, -- �̸�
	theater_floor    INT(11)      NOT NULL, -- ����
	theater_maxcount INT(11)      NOT NULL, -- �ο�
	seat_a           INT(11)      NOT NULL, -- �¼�A
	seat_b           INT(11)      NULL,     -- �¼�B
	seat_c           INT(11)      NULL,     -- �¼�C
	theater_type     VARCHAR(255) NOT NULL  -- �󿵰�����
);

-- theater
ALTER TABLE movie.theater
	ADD CONSTRAINT
		PRIMARY KEY (
			theater_no -- theater_no
		);

-- timetable
CREATE TABLE movie.timetable (
	table_no   INT(11) NOT NULL, -- �ð�ǥno
	movie_no   INT(11) NOT NULL, -- ��ȭ_no
	theater_no INT(11) NOT NULL, -- �󿵰�_no
	start_time DATE    NOT NULL, -- �濵���۽ð�
	end_time   DATE    NOT NULL  -- �濵����ð�
);

-- timetable
ALTER TABLE movie.timetable
	ADD CONSTRAINT
		PRIMARY KEY (
			table_no -- �ð�ǥno
		);

-- user
CREATE TABLE movie.user (
	user_id   VARCHAR(50)  NOT NULL, -- ȸ��id
	password  VARCHAR(50)  NOT NULL, -- ��й�ȣ
	point     INT(11)      NULL,     -- ����Ʈ
	email     VARCHAR(50)  NOT NULL, -- email
	phone     INT(11)      NOT NULL, -- ��ȭ��ȣ
	addr      VARCHAR(255) NOT NULL, -- �ּ�
	gender    VARCHAR(50)  NOT NULL, -- ����
	user_rank VARCHAR(50)  NULL      -- ȸ�����
);

-- user
ALTER TABLE movie.user
	ADD CONSTRAINT
		PRIMARY KEY (
			user_id -- ȸ��id
		);

-- user_rank
CREATE TABLE movie.user_rank (
	name     VARCHAR(50) NOT NULL, -- name
	discount INT(11)     NULL      -- discount
);

-- user_rank
ALTER TABLE movie.user_rank
	ADD CONSTRAINT
		PRIMARY KEY (
			name -- name
		);

-- board
ALTER TABLE movie.board
	ADD CONSTRAINT FK_movie_TO_board -- FK_movie_TO_board
		FOREIGN KEY (
			movie_no -- ��ȭ_no
		)
		REFERENCES movie.movie ( -- movie
			movie_no -- ��ȭ_no
		),
	ADD INDEX FK_movie_TO_board (
		movie_no -- ��ȭ_no
	);

-- board
ALTER TABLE movie.board
	ADD CONSTRAINT FK_user_TO_board -- FK_user_TO_board
		FOREIGN KEY (
			user_id -- ȸ��id
		)
		REFERENCES movie.user ( -- user
			user_id -- ȸ��id
		),
	ADD INDEX FK_user_TO_board (
		user_id -- ȸ��id
	);

-- reservation
ALTER TABLE movie.reservation
	ADD CONSTRAINT FK_timetable_TO_reservation -- FK_timetable_TO_reservation
		FOREIGN KEY (
			timetable_no -- �󿵽ð�ǥ_no
		)
		REFERENCES movie.timetable ( -- timetable
			table_no -- �ð�ǥno
		),
	ADD INDEX FK_timetable_TO_reservation (
		timetable_no -- �󿵽ð�ǥ_no
	);

-- reservation
ALTER TABLE movie.reservation
	ADD CONSTRAINT FK_user_TO_reservation -- FK_user_TO_reservation
		FOREIGN KEY (
			user_id -- ȸ��id
		)
		REFERENCES movie.user ( -- user
			user_id -- ȸ��id
		),
	ADD INDEX FK_user_TO_reservation (
		user_id -- ȸ��id
	);

-- timetable
ALTER TABLE movie.timetable
	ADD CONSTRAINT FK_movie_TO_timetable -- FK_movie_TO_timetable
		FOREIGN KEY (
			movie_no -- ��ȭ_no
		)
		REFERENCES movie.movie ( -- movie
			movie_no -- ��ȭ_no
		),
	ADD INDEX FK_movie_TO_timetable (
		movie_no -- ��ȭ_no
	);

-- timetable
ALTER TABLE movie.timetable
	ADD CONSTRAINT FK_theater_TO_timetable -- FK_theater_TO_timetable
		FOREIGN KEY (
			theater_no -- �󿵰�_no
		)
		REFERENCES movie.theater ( -- theater
			theater_no -- theater_no
		),
	ADD INDEX FK_theater_TO_timetable (
		theater_no -- �󿵰�_no
	);

-- user
ALTER TABLE movie.user
	ADD CONSTRAINT FK_user_rank_TO_user -- FK_user_rank_TO_user
		FOREIGN KEY (
			user_rank -- ȸ�����
		)
		REFERENCES movie.user_rank ( -- user_rank
			name -- name
		),
	ADD INDEX FK_user_rank_TO_user (
		user_rank -- ȸ�����
	);